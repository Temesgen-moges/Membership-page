{"ast":null,"code":"// src/middleware/HttpClient.jsx\n\nimport axios from 'axios';\nimport { useEffect } from 'react';\nimport { useKeycloak } from '@react-keycloak/web';\nconst HttpClient = () => {\n  var _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  const api = axios.create({\n    baseURL: 'http://localhost:3001',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  });\n  let token = null;\n\n  // Custom hook to get the authentication token\n  const useAuthToken = () => {\n    _s();\n    const {\n      keycloak\n    } = useKeycloak();\n    useEffect(() => {\n      const fetchToken = async () => {\n        if (!keycloak) return;\n        try {\n          await keycloak.updateToken(); // Ensure the token is updated\n          token = keycloak.token; // Retrieve the token from Keycloak\n        } catch (error) {\n          console.error('Error updating token:', error);\n        }\n      };\n      fetchToken();\n\n      // Cleanup function (optional)\n      return () => {\n        token = null; // Clear the token when the component unmounts\n      };\n    }, [keycloak]);\n    return token;\n  };\n\n  // Axios interceptor to attach the token to each request\n  _s(useAuthToken, \"DPTbhBezflouUoXkjGnL7ocRlhU=\", false, function () {\n    return [useKeycloak];\n  });\n  _s2(api.interceptors.request.use(_s2(config => {\n    _s2();\n    const authToken = useAuthToken(); // Call the custom hook to retrieve the token\n    if (authToken) {\n      config.headers.Authorization = `Bearer ${authToken}`;\n    }\n    return config;\n  }, \"HCiEd0m1+7snjR77r+PgW/A6CmE=\", false, function () {\n    return [useAuthToken];\n  }), error => {\n    return Promise.reject(error);\n  }), \"HCiEd0m1+7snjR77r+PgW/A6CmE=\", false, function () {\n    return [useAuthToken];\n  });\n};\n_c = HttpClient;\nexport default api;\nvar _c;\n$RefreshReg$(_c, \"HttpClient\");","map":{"version":3,"names":["axios","useEffect","useKeycloak","HttpClient","_s","$RefreshSig$","_s2","api","create","baseURL","headers","token","useAuthToken","keycloak","fetchToken","updateToken","error","console","interceptors","request","use","config","authToken","Authorization","Promise","reject","_c","$RefreshReg$"],"sources":["/home/wandi/Documents/Personal Projects/Intern Ship/frontend/game/src/middleware/HttpClient.jsx"],"sourcesContent":["// src/middleware/HttpClient.jsx\n\nimport axios from 'axios';\nimport { useEffect } from 'react';\nimport { useKeycloak } from '@react-keycloak/web';\n\nconst HttpClient= ()=>{\n\n\nconst api = axios.create({\n  baseURL: 'http://localhost:3001',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\nlet token = null;\n\n// Custom hook to get the authentication token\nconst useAuthToken = () => {\n  const { keycloak } = useKeycloak();\n\n  useEffect(() => {\n    const fetchToken = async () => {\n      if (!keycloak) return;\n\n      try {\n        await keycloak.updateToken(); // Ensure the token is updated\n        token = keycloak.token; // Retrieve the token from Keycloak\n      } catch (error) {\n        console.error('Error updating token:', error);\n      }\n    };\n\n    fetchToken();\n\n    // Cleanup function (optional)\n    return () => {\n      token = null; // Clear the token when the component unmounts\n    };\n  }, [keycloak]);\n\n  return token;\n};\n\n// Axios interceptor to attach the token to each request\napi.interceptors.request.use(\n  (config) => {\n    const authToken = useAuthToken(); // Call the custom hook to retrieve the token\n    if (authToken) {\n      config.headers.Authorization = `Bearer ${authToken}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n}\n\nexport default api;\n"],"mappings":"AAAA;;AAEA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,OAAO;AACjC,SAASC,WAAW,QAAQ,qBAAqB;AAEjD,MAAMC,UAAU,GAAEA,CAAA,KAAI;EAAA,IAAAC,EAAA,GAAAC,YAAA;IAAAC,GAAA,GAAAD,YAAA;EAGtB,MAAME,GAAG,GAAGP,KAAK,CAACQ,MAAM,CAAC;IACvBC,OAAO,EAAE,uBAAuB;IAChCC,OAAO,EAAE;MACP,cAAc,EAAE;IAClB;EACF,CAAC,CAAC;EAEF,IAAIC,KAAK,GAAG,IAAI;;EAEhB;EACA,MAAMC,YAAY,GAAGA,CAAA,KAAM;IAAAR,EAAA;IACzB,MAAM;MAAES;IAAS,CAAC,GAAGX,WAAW,CAAC,CAAC;IAElCD,SAAS,CAAC,MAAM;MACd,MAAMa,UAAU,GAAG,MAAAA,CAAA,KAAY;QAC7B,IAAI,CAACD,QAAQ,EAAE;QAEf,IAAI;UACF,MAAMA,QAAQ,CAACE,WAAW,CAAC,CAAC,CAAC,CAAC;UAC9BJ,KAAK,GAAGE,QAAQ,CAACF,KAAK,CAAC,CAAC;QAC1B,CAAC,CAAC,OAAOK,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;QAC/C;MACF,CAAC;MAEDF,UAAU,CAAC,CAAC;;MAEZ;MACA,OAAO,MAAM;QACXH,KAAK,GAAG,IAAI,CAAC,CAAC;MAChB,CAAC;IACH,CAAC,EAAE,CAACE,QAAQ,CAAC,CAAC;IAEd,OAAOF,KAAK;EACd,CAAC;;EAED;EAAAP,EAAA,CA1BMQ,YAAY;IAAA,QACKV,WAAW;EAAA;EA0BlCI,GAAA,CAAAC,GAAG,CAACW,YAAY,CAACC,OAAO,CAACC,GAAG,CAAAd,GAAA,CACzBe,MAAM,IAAK;IAAAf,GAAA;IACV,MAAMgB,SAAS,GAAGV,YAAY,CAAC,CAAC,CAAC,CAAC;IAClC,IAAIU,SAAS,EAAE;MACbD,MAAM,CAACX,OAAO,CAACa,aAAa,GAAI,UAASD,SAAU,EAAC;IACtD;IACA,OAAOD,MAAM;EACf,CAAC;IAAA,QALmBT,YAAY;EAAA,IAM/BI,KAAK,IAAK;IACT,OAAOQ,OAAO,CAACC,MAAM,CAACT,KAAK,CAAC;EAC9B,CACF,CAAC;IAAA,QATqBJ,YAAY;EAAA;AAWlC,CAAC;AAAAc,EAAA,GArDKvB,UAAU;AAuDhB,eAAeI,GAAG;AAAC,IAAAmB,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}